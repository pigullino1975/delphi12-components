<?xml version="1.0"?><slice timestamp="25.06.2008 14:01:48"><selection col="-1" row="-1" measure="-1"/><page_fields><page_field field_name="Менеджер" caption="Менеджер" rfname="Менеджер"/></page_fields><xaxis_fields><xaxis_field field_name="#MEASURES" caption="Показатели" order="1" make_total="0" expanded="0" alignment="taCenter" rfname="#MEASURES"/></xaxis_fields><yaxis_fields><yaxis_field field_name="Клиент" caption="Клиент" order="1" make_total="-1" expanded="-1" alignment="taLeftJustify" rfname="Клиент"/></yaxis_fields><measure_fields><measure_field calculated="-1" caption="Список продукции" rfname="Показатель_1" aggregate="af_Formula" display="da_Value" visible="-1" alignment="taRightJustify" formula="var&#13;&#10;  i, j: integer;&#13;&#10;  AArrayProd: array of string;&#13;&#10;  AProd: string;&#13;&#10;begin&#13;&#10;  Result := '';&#13;&#10;  SetLength(AArrayProd, 0);&#13;&#10;  Measures.PrepareDetailInfo;&#13;&#10;  for i := 0 to Measures.RecordCount - 1 do&#13;&#10;  begin&#13;&#10;    AProd := Measures.DetailValue[i, 'Продукция'];&#13;&#10;    for j := 0 to Length(AArrayProd) - 1 do&#13;&#10;      if AArrayProd[j] = AProd then&#13;&#10;      begin&#13;&#10;        AProd := '';&#13;&#10;        break;&#13;&#10;      end;&#13;&#10;    if AProd &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;      SetLength(AArrayProd, Length(AArrayProd) + 1);&#13;&#10;      AArrayProd[Length(AArrayProd) - 1] := AProd;&#13;&#10;      if Result = '' then&#13;&#10;        Result := Result + AProd&#13;&#10;      else&#13;&#10;        Result := Result + ', ' + AProd&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end.&#13;&#10;" calculation_order="1" filter=""><display_format decimal_separator="" format_str="" kind="fkText"/></measure_field></measure_fields><fields><field name="#Day_Дата" caption="День_Дата" Width="0" Height="0" PopUpWidth="120"/><field name="#DayOfWeeek_Дата" caption="День_недели_Дата" Width="0" Height="0" PopUpWidth="120"/><field name="#Month_Дата" caption="Месяц_Дата" Width="0" Height="0" PopUpWidth="120"/><field name="#Quarter_Дата" caption="Квартал_Дата" Width="0" Height="0" PopUpWidth="120"/><field name="#Year_Дата" caption="Год_Дата" Width="0" Height="0" PopUpWidth="120"/><field name="Дата" caption="Дата" Width="0" Height="0" PopUpWidth="120"/><field name="Клиент" caption="Клиент" Width="100" Height="0" PopUpWidth="120"/><field name="Количество" caption="Количество" Width="0" Height="0" PopUpWidth="120"/><field name="Менеджер" caption="Менеджер" Width="136" Height="0" PopUpWidth="120"/><field name="Накрутка" caption="Накрутка" Width="0" Height="0" PopUpWidth="120"/><field name="Оплачено" caption="Оплачено" Width="0" Height="0" PopUpWidth="120"/><field name="Продукция" caption="Продукция" Width="0" Height="0" PopUpWidth="120"/><field name="Сальдо" caption="Сальдо" Width="0" Height="0" PopUpWidth="120"/><field name="Стоимость" caption="Стоимость" Width="0" Height="0" PopUpWidth="120"/><field name="ТипОплаты" caption="ТипОплаты" Width="0" Height="0" PopUpWidth="120"/><field name="#MEASURES" caption="Показатели" Width="0" Height="20" PopUpWidth="140"/></fields><options hide_col_zeros="0" hide_row_zeros="0" sort_x="md_tsa_ByAxisValue" sort_y="md_tsa_ByAxisValue" PopUpFieldListWidth="120"/><sizes><y_sizes><field_width item="0" width="100"/></y_sizes><x_sizes><col_width item="0" width="350"/></x_sizes></sizes></slice>